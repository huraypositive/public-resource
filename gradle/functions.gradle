def gitGetCurrentBranch() {
    if(System.getenv("BRANCH_NAME") != null)
        return System.getenv("BRANCH_NAME")
    if(System.getenv("GIT_BRANCH") != null)
        return System.getenv("GIT_BRANCH")
    def branch = ""
    def proc = "git rev-parse --abbrev-ref HEAD".execute()
    proc.in.eachLine { line -> branch = line }
    proc.err.eachLine { line -> println line }
    proc.waitFor()
    return branch
}

ext {
    def branch = gitGetCurrentBranch()
}
